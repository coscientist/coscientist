---
title: "2026-01-19"
description: "로케일 내비게이션 수정, 헤더 액션 개선, 선언문 노트 로딩 최적화"
---

## 선언문 로케일 내비게이션 수정

**범위**: `apps/web`

### 변경 사항

| 파일 | 변경 사항 |
| ---- | --------- |
| `src/lib/use-note-stack.ts` | next-intl 라우터로 교체해 로케일 인지 스택 URL을 생성하고 비영어 노트 클릭 시 전체 리로드를 방지. |

### 기술적 결정

1. **로케일 인지 라우터**: `@/i18n/navigation`의 `useRouter`를 사용해 스택 URL 업데이트가 로케일 접두사와 쿠키 동기화를 반영하도록 하여 전체 리로드를 방지.

### 검증

- TypeScript: 미실행 (요청 없음)
- Build: 미실행 (요청 없음)
- Tests: 미실행 (요청 없음)

### 다음 단계

없음.

## 선언문 노트 로딩 최적화

**범위**: `apps/web`

### 변경 사항

| 파일 | 변경 사항 |
| ---- | --------- |
| `src/lib/notes/markdown-parser.ts` | 노트 그래프 구축 시 HTML 변환을 피하기 위해 경량 프론트매터 파서를 추가. |
| `src/lib/notes/note-loader.ts` | 전체 노트 로딩과 그래프 노드 로딩을 분리하고, 그래프 노드 캐싱 및 전체 노트의 outbound 링크 파싱을 제거. |
| `src/lib/notes/graph-builder.ts` | 경량 노드로 백링크를 구성하고 요약 노트 맵만 반환하도록 변경. |
| `src/lib/notes/index.ts` | 노트 그래프 빌드를 React cache로 감싸 요청 단위 중복을 제거. |
| `src/lib/types.ts` | 그래프 노드/전체 노트 타입을 분리하고 사용하지 않는 inbound/outbound 링크 필드를 제거. |
| `src/app/[locale]/manifesto/[[...slug]]/page.tsx` | URL search params가 스택 렌더링을 구동하도록 서버 래퍼에 전달. |
| `src/app/[locale]/manifesto/[[...slug]]/client-wrapper.tsx` | 활성 스택에만 전체 노트 콘텐츠를 로딩하고 그래프/패널 로딩을 병렬화. |
| `src/app/[locale]/manifesto/[[...slug]]/client-wrapper.tsx` | nullable 타입 가드를 피하기 위해 reduce 기반 패널 구성으로 변경. |
| `src/components/client/index.tsx` | 스택 전용 패널 데이터에 맞게 props 명칭 정리. |
| `src/components/client/pane-orchestrator.tsx` | 스택이 데이터보다 먼저 갱신될 때 닫기 동작을 안전하게 처리하고 가시 패널 기준으로 스택 삽입 정렬. |
| `src/components/client/mobile-orchestrator.tsx` | 모바일에서 가용 패널 기준으로 닫기 동작을 맞춤. |
| `src/components/pane/container.tsx` | 스택 전용 패널 데이터로 모바일 오케스트레이션을 연결. |

### 기술적 결정

1. **스택 전용 payload**: 활성 스택에 필요한 HTML만 전달하고, nuqs 기반 URL 업데이트로 RSC가 패널을 갱신하도록 구성.
2. **경량 그래프 파싱**: 백링크 구축은 프론트매터만 파싱해 HTML 변환 비용을 제거.
3. **그래프 캐싱**: 그래프 빌드를 React cache로 감싸 요청 단위 중복을 제거.

### 검증

- TypeScript: 통과
- Build: 통과
- Tests: 미실행 (요청 없음)

### 다음 단계

없음.

## Hugeicons 의존성 설치

**범위**: `apps/web`

### 변경 사항

| 파일 | 변경 사항 |
| ---- | --------- |
| `package.json` | `@hugeicons/react`, `@hugeicons/core-free-icons` 의존성 추가. |
| `bun.lock` | Hugeicons 패키지 lockfile 갱신. |
| `AGENTS.md` | 기술 스택에 Hugeicons 명시. |

### 기술적 결정

1. **아이콘 시스템 정합성**: UI 컴포넌트에서 참조하는 Hugeicons 패키지를 설치해 아이콘 사용을 일관되고 타입 안전하게 유지.

### 검증

- TypeScript: 통과
- Build: 통과
- Tests: 미실행 (요청 없음)

### 다음 단계

없음.

## 헤더 액션 모바일 최적화

**범위**: `apps/web`

### 변경 사항

| 파일 | 변경 사항 |
| ---- | --------- |
| `src/components/layout/app-header.tsx` | 모바일에서는 아이콘 전용 대기열 버튼을 노출하고, 데스크톱에서는 기존 라벨 버튼을 유지. |

### 기술적 결정

1. **반응형 CTA 교체**: 새 번역 키 없이 Tailwind 브레이크포인트로 텍스트/아이콘 버튼을 교체해 헤더 폭을 줄임.

### 검증

- TypeScript: 미실행 (요청 없음)
- Build: 미실행 (요청 없음)
- Tests: 미실행 (요청 없음)

### 다음 단계

없음.

## 헤더 모바일 시트

**범위**: `apps/web`

### 변경 사항

| 파일 | 변경 사항 |
| ---- | --------- |
| `src/components/layout/app-header.tsx` | 모바일 헤더 액션을 하단 시트로 교체하고 대기열, GitHub, 언어, 테마 제어를 포함. |
| `src/components/language-switcher.tsx` | 모바일 시트 재사용을 위해 로케일 이름 매핑을 export. |

### 기술적 결정

1. **시트 기반 액션**: Base UI `Sheet`를 하단에서 열어 모바일에서 충분한 터치 타겟을 유지.

### 검증

- TypeScript: 미실행 (요청 없음)
- Build: 미실행 (요청 없음)
- Tests: 미실행 (요청 없음)

### 다음 단계

없음.

## Hugeicons 전환

**범위**: `apps/web`

### 변경 사항

| 파일 | 변경 사항 |
| ---- | --------- |
| `next.config.ts` | Hugeicons 패키지로 아이콘 트랜스파일 대상을 변경. |
| `package.json` | Nucleo 의존성을 제거하고 Hugeicons 패키지를 추가. |
| `src/components/**` | Nucleo/Lucide 아이콘 사용을 HugeiconsIcon + 무료 아이콘 세트로 교체. |
| `AGENTS.md` | 아이콘 가이드라인을 Hugeicons 기준으로 수정. |

### 기술적 결정

1. **단일 아이콘 시스템**: 아이콘 스타일 혼재를 피하기 위해 Hugeicons로 통일.

### 검증

- TypeScript: 미실행 (요청 없음)
- Build: 미실행 (요청 없음)
- Tests: 미실행 (요청 없음)

### 다음 단계

없음.

## 선언문 한국어 문체 정비

**범위**: `apps/web`

### 변경 사항

| 파일 | 변경 |
| ---- | ---- |
| `src/content/manifesto/ko/*.md` | 선언문 한국어를 학술적·단정적 문체로 재정비하고 핵심 용어 표기를 표준화함(예: 책임선, 증거 구간, 다국어 지식 메쉬). |

### 기술적 결정

1. **문체 통일**: 완곡·추정 표현을 줄이고 단정형 서술로 통일.
2. **용어 정렬**: 핵심 용어 표기를 일관화해 노트 간 표현 불일치를 축소.

### 검증

- TypeScript: 실행하지 않음 (콘텐츠 변경)
- Build: 실행하지 않음 (요청 없음)
- Tests: 실행하지 않음 (요청 없음)

### 다음 단계

없음.

## GitHub 링크 수정 및 문서화

**범위**: `apps/web`

### 변경 사항

| 파일 | 변경 사항 |
| ---- | --------- |
| `src/components/layout/app-header.tsx` | 모바일 서랍의 GitHub 버튼에 "opens in new tab" 텍스트와 외부 링크 아이콘을 추가. |
| `AGENTS.md` | 중첩 시트(Nested Sheet) 패턴 문서를 추가. |

### 기술적 결정

1. **명시적 외부 링크 표시**: GitHub 링크가 앱 외부로 이동함을 명확히 하기 위해 텍스트와 아이콘을 추가하여 UX/접근성 개선.
2. **문서화**: 드릴다운 메뉴의 일관된 구현을 위해 중첩 시트 패턴을 문서화.

### 검증

- TypeScript: 통과
- Build: 통과
- Tests: 미실행 (요청 없음)

### 다음 단계

없음.
